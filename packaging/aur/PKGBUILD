pkgname=xsarena
pkgver=0.1.0
pkgrel=1
pkgdesc="LMASudio/xsarena: AI writing & study studio CLI (books, lossless, study, bilingual)"
arch=('any')
url="https://github.com/tazdev-ops/xsarena"
license=('MIT')
depends=(
  'python'
  'python-aiohttp'
  'python-typer'
  'python-pydantic'
  'python-dotenv'
)
optdepends=(
  'python-textual: TUI (lma_tui.py)'
  'python-watchdog: watch mode for file pipelines'
  'python-pytest: run test_cli.py locally'
)
makedepends=(
  'python-build'
  'python-installer'
  'python-wheel'
)
_source_tar="${pkgname}-${pkgver}.tar.gz"
source=("${_source_tar}::https://github.com/tazdev-ops/xsarena/archive/refs/tags/v${pkgver}.tar.gz")
sha256sums=('SKIP')  # replace with real sum via updpkgsums

build() {
  cd "${srcdir}/xsarena-${pkgver}"
  python -m build --wheel --no-isolation
}

package() {
  cd "${srcdir}/xsarena-${pkgver}"
  python -m installer --destdir="${pkgdir}" dist/*.whl

  # wrapper: `xsarena` -> `lmastudio`
  install -Dm755 /dev/stdin "${pkgdir}/usr/bin/xsarena" << 'EOF'
#!/usr/bin/env bash
exec lmastudio "$@"
EOF

  # docs
  install -Dm644 README.md "${pkgdir}/usr/share/doc/${pkgname}/README.md"

  # license (expects LICENSE in repo root)
  install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
